<!DOCTYPE html>
<html lang="en">
<head>
  	<meta charset="utf-8" />
	<title>Converting Userscript to Chrome Extension: The monkeys are no longer needed</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" property="og:description" content="Userscripts are a very useful and handy tool in the hands of power users. Just like customized garnishing, salt and pepper, etc. we put on our food before we eat, we can add custom javascript tweaks on the websites we visit. For example, you may want Reddit to automatically highlight …">
	<link rel="canonical" content="https://prahladyeri.github.io/blog/2022/10/converting-userscripts-to-chrome-extensions.html" />
	<meta name="author" content="Prahlad Yeri">
	<link rel="stylesheet" href="/theme/css/app.css?v=1.8">
	<link rel="stylesheet" href="/theme/css/pygment.css">		
	<link rel="shortcut icon" type="image/x-icon" href="/uploads/py.png" />
	<link href="https://prahladyeri.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Prahlad Yeri's Blog Full Atom Feed" />
	<link href="https://prahladyeri.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Prahlad Yeri's Blog Full RSS Feed" />
	<link href="https://prahladyeri.github.io/feeds/{slug}.atom.xml" type="application/atom+xml" rel="alternate" title="Prahlad Yeri's Blog Categories Atom Feed" />




    <meta name="tags" content="JavaScript" />
    <meta name="tags" content="Userscripts" />
    <meta name="tags" content="Extensions" />

	
	<!-- fosstodon verify -->
	<a style='display:none'  rel="me" href="https://fosstodon.org/@prahladyeri">Fosstodon</a>
	<!-- mastodon verify -->
	<a style='display:none' rel="me" href="https://mastodon.social/@prahladyeri">Mastodon</a>
	
	<!-- pinterest verify -->
	<meta name="p:domain_verify" content="a57360faef2ee56807b63d62092a849a"/>
	
	<!-- twitter card meta data -->
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:site" content="@prahladyeri" />
	<meta name="twitter:creator" content="@prahladyeri" />
		<meta name="twitter:url" content="https://prahladyeri.github.io/blog/2022/10/converting-userscripts-to-chrome-extensions.html" />
		<meta name="twitter:title" content="Converting Userscript to Chrome Extension: The monkeys are no longer needed" />
		<meta name="twitter:description" content="Userscripts are a very useful and handy tool in the hands of power users. Just like customized garnishing, salt and pepper, etc. we put on our food before we eat, we can add custom javascript tweaks on the websites we visit. For example, you may want Reddit to automatically highlight …" />
			<meta name="twitter:image" content="https://prahladyeri.github.io/uploads/code.jpg" />
			<meta name="image" property="og:image" content="https://prahladyeri.github.io/uploads/code.jpg">

	
	
</head>

<body>
<div id='header'>
<div class='text-center' >
	<h1 class='blog-title'>Prahlad Yeri</h1>
	<h4  class='blog-tagline'>Freelance Programmer and Writer</h4>
</div>

<div id='navBlock' class='text-center' >
	<a class="nav-link" href="/">Home</a> | 
	<a class="nav-link" href="/blog">Blog</a> | 
	<a class="nav-link" href="/portfolio">Portfolio</a> | 
	<a class="nav-link" href="https://github.com/prahladyeri/resume">Resume</a> | 
	<a class="nav-link" href="/hire-me">Hire Me</a>
	<br>
	Social:
	<a class="nav-link" href="https://twitter.com/prahladyeri">Twitter</a> | 
	<a class="nav-link" href="https://github.com/prahladyeri">Github</a> | 
	<a class="nav-link" href="https://www.linkedin.com/in/prahlad-yeri-243a5316">Linkedin</a> | 
	<a class="nav-link" href="https://prahladyeri.medium.com/">Medium</a> | 
	<a class="nav-link" href="https://www.quora.com/profile/Prahlad-Yeri">Quora</a>
	<br>
	Email: prahladyeri at yahoo dot com | 
	Feeds:
	<a class="nav-link" href="/feeds/all.rss.xml">RSS</a> | 
	<a class="nav-link" href="/feeds/all.atom.xml">ATOM</a>
</div>
</div>
<div id="main" class='row content '>
<div class='col w50 m-auto'>
<section id="content" class="body">
  <header>
	<h1 class='mt-4 mb-4'>Converting Userscript to Chrome Extension: The monkeys are no longer needed</h1>
 
  </header>
  <footer class="post-info clearfix">
	<span class='float-left'>
    <time class="text-muted published" datetime="2022-10-14T08:00:00+05:30">2022-10-14</time>
    <div class="text-muted vcard author">
      By           <a class="url fn" href="https://prahladyeri.github.io/">Prahlad Yeri</a>
    </div>
	</span>
	<div class='float-right'>
    <div class="text-muted category text-right">
        Filed under <a href="https://prahladyeri.github.io/blog/category/javascript">JavaScript</a>
    </div>
    <div class="text-muted tags">
		Tags
            <a href="https://prahladyeri.github.io/blog/tag/javascript">JavaScript</a>
            <a href="https://prahladyeri.github.io/blog/tag/userscripts">Userscripts</a>
            <a href="https://prahladyeri.github.io/blog/tag/extensions">Extensions</a>
    </div>
	</div>
  </footer><!-- /.post-info -->
  
  <div class="entry-content">
    <p><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/userScripts">Userscripts</a> are a very useful and handy tool in the hands of power users. Just like customized garnishing, salt and pepper, etc. we put on our food before we eat, we can add custom javascript tweaks on the websites we visit.</p>
<p>For example, you may want Reddit to automatically highlight the recently posted (unread) comments on a post or thread. Another example is that when you perform a Google search, you may want trusted sites highlighted specifically (based on a pre-filtered list if you have one).</p>
<p>The classical or traditional way of running these userscripts is by using the "monkey" extensions, the most popular of them being <a href="https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/">Greasemonkey</a> and <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo?hl=en">Tampermonkey</a>.</p>
<p>These extensions allow you to write scripts that execute when you visit the particular sites for them. While this is a great way of using userscripts, the better and more efficient way is to always convert them into browser extensions.</p>
<p>Extensions run natively in your browsers as you're using one less execution layer. Besides, some extensions like Tampermonkey also update themselves too frequently (perhaps to keep up with the browser updates) and that might cause compatibility issues.</p>
<p>While comprehensive extension development is beyond the scope of this blog post, the conversion from a userscript to a basic chrome extension is quite straightforward. All you have to create is a folder for your extension and create two files named <code>manifest.json</code> and <code>content.js</code>. The <code>content.js</code> is where you'll place the javascript code presently in your script file. Two important points to note here is that there should be no use of special <code>GM_*</code> functions and you must not use any <code>return</code> statement unless it's inside a function.</p>
<p>Here is a very basic <code>manifest.json</code> example.</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;manifest_version&quot;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Reddit Plus&quot;</span><span class="p">,</span>
<span class="s2">&quot;description&quot;</span><span class="o">:</span> <span class="s2">&quot;Highlight unread comments and mark them in blue.&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="o">:</span> <span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
<span class="s2">&quot;icons&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;16&quot;</span><span class="o">:</span> <span class="s2">&quot;icon.png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;48&quot;</span><span class="o">:</span> <span class="s2">&quot;icon.png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;128&quot;</span><span class="o">:</span> <span class="s2">&quot;icon.png&quot;</span>
  <span class="p">},</span>
<span class="s2">&quot;content_scripts&quot;</span><span class="o">:</span><span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;matches&quot;</span><span class="o">:</span><span class="p">[</span>
        <span class="s2">&quot;https://*.reddit.com/*&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;exclude_matches&quot;</span><span class="o">:</span><span class="p">[</span>
        <span class="s2">&quot;https://*.reddit.com/test/*&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;js&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;lib/jquery.min.js&quot;</span><span class="p">,</span> <span class="s2">&quot;content.js&quot;</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">],</span>
<span class="s2">&quot;browser_action&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;default_icon&quot;</span><span class="o">:</span> <span class="s2">&quot;icon.png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;default_popup&quot;</span><span class="o">:</span> <span class="s2">&quot;popup.html&quot;</span>
  <span class="p">},</span>

  <span class="s2">&quot;background&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;scripts&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;background.js&quot;</span><span class="p">],</span>
      <span class="s2">&quot;persistent&quot;</span><span class="o">:</span> <span class="kc">false</span>
    <span class="p">},</span>
<span class="s2">&quot;permissions&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="s2">&quot;activeTab&quot;</span><span class="p">,</span>
    <span class="s2">&quot;storage&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://ajax.googleapis.com/&quot;</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<p>My userscript also depends on jquery and instead of calling it through the CDN, I've included it as a separate script under "lib" folder as "lib/jquery.min.js". Having an <code>icon.png</code> helps you distinguish the extension form others. The <code>background.js</code> is required as an empty placeholder. So, there are 5 files in total (the last one being optional):</p>
<ul>
<li>manifest.json</li>
<li>content.js</li>
<li>icon.png</li>
<li>background.js</li>
<li>lib/jquery.min.js</li>
</ul>
<p>Once you have this structure, just go to <code>chrome://extensions</code> on your browser and switch on the "Developer Mode". This will allow you to install unpacked extensions. Just click on the "Load Unpacked" and browse your extension folder.</p>
<p>That's it! You can now test your extension by visiting the site just like you did with userscripts and the monkey extensions. This was for chrome browser which I happen to use but extension development workflow for other browsers like firefox or edge shouldn't be much different than this. Let me know how your userscript to extension conversion goes in the comments below.</p>
  </div><!-- /.entry-content -->

	<!-- Start: Prahlad -->
	<script>
	document.addEventListener('DOMContentLoaded', function(){
		console.log('DOMContentLoaded');
		var elems = document.querySelectorAll(".entry-content table");
		for(var i= 0;i<elems.length;i++) {
			if (!hasClass(elems[i], 'table')) addClass(elems[i], 'table');
			if (!hasClass(elems[i], 'table-bordered')) addClass(elems[i], 'table-bordered');
			if (!hasClass(elems[i], 'table-sm')) addClass(elems[i], 'table-sm');
		}
		document.querySelector(".entry-content img").parentElement.style.textAlign = "center";
	});
	</script>

	<!--start: adsense-->
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0428291735937735"
     crossorigin="anonymous"></script>
	<!-- prahladyeri.github.io -->
	<ins class="adsbygoogle"
		 style="display:block"
		 data-ad-client="ca-pub-0428291735937735"
		 data-ad-slot="9729062115"
		 data-ad-format="auto"
		 data-full-width-responsive="true"></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
	<!--end: adsense-->
	
	
	
	<!-- End: Prahlad -->
</section>
</div>
</div>


<footer id ="footer" class="text-center">
Copyright (&copy;) 2014-2023 Prahlad Yeri.<br>This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</footer>

<script>
function hasClass(ele,cls) {
  return !!ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}
</script>

</body>
</html>